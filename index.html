<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1-9반 급식표</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <div class="header">
        <img src="orang.png" alt="" class="orang">
        <div class="info">대신고등학교 1학년 9반</div>
        <div class="ct" id="ct"></div>
    </div>

    <div class="dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            급식표
        </a>
        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
          <li><a class="dropdown-item" href="index.html">급식표</a></li>
          <li><a class="dropdown-item" href="schedule.html">시간표</a></li>
          <li><a class="dropdown-item" href="patchnote.html">패치노트</a></li>
        </ul>
      </div>

    <div class="content">
        <div id="time0"></div>
        <div id="value0"></div>
        <div id="time1"></div>
        <div id="value1"></div>
    </div>
    <div class="footer">
        <h1 class="myname">Made By 10914 백현빈</h1>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script>
        var request;
                if (window.XMLHttpRequest) {
                    request = new XMLHttpRequest;
                }
            
                let today=new Date();
                var year = today.getFullYear();
                var month = ('0' + (today.getMonth() + 1)).slice(-2);
                var date = ('0' + today.getDate()).slice(-2);
                document.getElementById('ct').innerHTML = month + '월 '+ date +'일'

                request.open("GET","https://open.neis.go.kr/hub/mealServiceDietInfo?ATPT_OFCDC_SC_CODE=G10&SD_SCHUL_CODE=7430048&KEY=ef5c41c7fa004a8bb4e7ef6fb7ce58bc&MLSV_YMD=" + year + month + date);
                request.send();

                        request.onreadystatechange = function() {
                    if (request.readyState == 4) {
                    
                        if (request.status >= 200 && request.status < 300) {
                            var xml = request.responseXML;
                            
                            var names = xml.getElementsByTagName("DDISH_NM");
                            var ages = xml.getElementsByTagName("MMEAL_SC_NM");
                            for (var i = 0; i < names.length; i++) {
                                var value = names[i].childNodes[0].nodeValue;
                                var time = ages[i].childNodes[0].nodeValue;
                                console.log(time + ":" + value);
                                console.log('hello' + i)
                                document.getElementById('time' + i).innerHTML = time
                                document.getElementById('value' + i).innerHTML = value
                            }
 
                            //요청하는게 xml이면 responseXML 일반텍스트면 response
 
                        } else {
                            alert(request.status);
                        }
                    }
                }
            
    </script>

</body>
</html>